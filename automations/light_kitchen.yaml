    ##############################################
    ### Tänder lampor 100%                     ###
    ### T: input_select.kitchen_lights == 100% ###
    ### A: script.kitchen_light_100            ###
    ##############################################
  - alias: Tänd Kök 100%
    mode: single

    trigger:
      - platform: state
        entity_id: input_select.kitchen_lights
        to: 100%

    action:
      - service: script.kitchen_light_100

    #############################################
    ### Tänder lampor 25%                     ###
    ### T: input_select.kitchen_lights == 25% ###
    ### A: script.kitchen_light_25            ###
    #############################################
  - alias: Tänd Kök 25%
    mode: single

    trigger:
      - platform: state
        entity_id: input_select.kitchen_lights
        to: 100%

    action:
      - service: script.kitchen_light_25

    #############################################
    ### Släcker lampor                        ###
    ### T: input_select.kitchen_lights == Off ###
    ### A: script.kitchen_light_off           ###
    #############################################
  - alias: Släck Kök
    mode: single

    trigger:
      - platform: state
        entity_id: input_select.kitchen_lights
        to: 100%

    action:
      - service: script.kitchen_light_off

    #######################################################################
    ### Tänder lampor 100% när lux kommer under 2500                    ###
    ### För att förhindra att det inte tänds när någon redan är i köket ###
    ### T: sensor.ljusstyrka < input_number.kitchen_light_on            ###
    ### C: 12:00:00 - 22:00:00                                          ###
    ### C: group.track_for_home_devices == 'home'                       ###
    ### A: input_select.kitchen_lights = 100%                           ###
    #######################################################################
  - alias: Kök 100% (<2500)
    mode: single

    trigger:
      - platform: template
        value_template: "{{(states('sensor.ljusstyrka') | int) < (states('input_number.kitchen_light_on') | int )}}"

    condition:
      condition: and
      conditions:
        - condition: time
          after: '12:00:00'
          before: '22:00:00'
        - condition: state
          entity_id: group.track_for_home_devices
          state: 'home'

    action:
      - service: input_select.select_option
        data:
          entity_id: input_select.kitchen_lights
          option: 100%

    #####################################################################
    ### Tänder lampor 100% på morgonen vid rörelse i köket < 2500 lux ###
    ### T: input_boolean.rorelsedetektor_kok_aktiv == on              ###
    ### C: sensor.ljusstyrka < input_number.kitchen_light_on          ###
    ###    05:00:00 - 12:00:00                                        ###
    ### A: input_select.kitchen_lights = 100%                         ###
    #####################################################################
  - alias: Kök 100% morgon (sensor on, <2500)
    mode: queued

    trigger:
      - platform: state
        entity_id: input_boolean.rorelsedetektor_kok_aktiv
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_1
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_2
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_3
        to: 'on'

    condition:
      condition: and
      conditions:
        - condition: template
          value_template: "{{(states('sensor.ljusstyrka') | int) < (states('input_number.kitchen_light_on') | int )}}"
        - condition: time
          after: '05:00:00'
          before: '12:00:00'

    action:
      - service: input_select.select_option
        data:
          entity_id: input_select.kitchen_lights
          option: 100%

    #####################################################################
    ### Tänder lampor 100% vid rörelse i köket 150-2500 lux övrig tid ###
    ### T: input_boolean.rorelsedetektor_kok_aktiv == on              ###
    ### C: sensor.ljusstyrka 150-input_number.kitchen_light_on        ###
    ###    12:00:00 - 05:00:00                                        ###
    ### A: input_select.kitchen_lights = 100%                         ###
    #####################################################################
  - alias: Kök 100% (sensor on, 150-2500)
    mode: queued

    trigger:
      - platform: state
        entity_id: input_boolean.rorelsedetektor_kok_aktiv
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_1
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_2
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_3
        to: 'on'

    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.ljusstyrka
          above: 150
        - condition: template
          value_template: "{{(states('sensor.ljusstyrka') | int) < (states('input_number.kitchen_light_on') | int )}}"
        - condition: time
          after: '12:00:00'
          before: '05:00:00'

'   action:
      - service: input_select.select_option
        data:
          entity_id: input_select.kitchen_lights
          option: 100%

    ##################################################################
    ### Tänder lampor 100% övrig tid vid rörelse i köket 0-150 lux ###
    ### T: input_boolean.rorelsedetektor_kok_aktiv == on           ###
    ### C: sensor.ljusstyrka 0-150                                 ###
    ###    12:00:00 - 05:00:00                                     ###
    ###    light.kok_lilla_fonstret == 'on'                        ###
    ### A: input_select.kitchen_lights = 100%                      ###
    ##################################################################
  - alias: Kök 100% (sensor on, 0-150)
    mode: queued

    trigger:
      - platform: state
        entity_id: input_boolean.rorelsedetektor_kok_aktiv
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_1
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_2
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_3
        to: 'on'

    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.ljusstyrka
          below: 150
        - condition: time
          after: '12:00:00'
          before: '05:00:00'
        - condition: state
          entity_id: light.kok_lilla_fonstret
          state: 'on'

    action:
      - service: input_select.select_option
        data:
          entity_id: input_select.kitchen_lights
          option: 100%

    #####################################################################################
    ### Tänder lampor 100% övrig tid vid rörelse i köket 0-150 lux när ingen är hemma ###
    ### T: input_boolean.rorelsedetektor_kok_aktiv == on                              ###
    ### C: group.track_for_home_devices == 'not_home'                                 ###
    ###    sensor.ljusstyrka 0-150                                                    ###
    ###    12:00:00 - 05:00:00                                                        ###
    ###    light.kok_lilla_fonstret == 'off'                                          ###
    ### A: input_select.kitchen_lights = 100%                                         ###
    #####################################################################################
  - alias: Kök 100% (sensor on, Borta, 0-150)
    mode: queued

    trigger:
      - platform: state
        entity_id: input_boolean.rorelsedetektor_kok_aktiv
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_1
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_2
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_3
        to: 'on'

    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: group.track_for_home_devices
          state: 'not_home'
        - condition: numeric_state
          entity_id: sensor.ljusstyrka
          below: 150
        - condition: time
          after: '12:00:00'
          before: '05:00:00'
        - condition: state
          entity_id: light.kok_lilla_fonstret
          state: 'off'

    action:
      - service: input_select.select_option
        data:
          entity_id: input_select.kitchen_lights
          option: 100%

    ####################################################################################
    ### Tänder lampor 25% övrig tid vid rörelse i köket 0-150 lux när någon är hemma ###
    ### T: input_boolean.rorelsedetektor_kok_aktiv == on                             ###
    ### C: group.track_for_home_devices == 'home'                                    ###
    ###    sensor.ljusstyrka 0-150                                                   ###
    ###    12:00:00 - 05:00:00                                                       ###
    ###    light.kok_lilla_fonstret == 'off'                                         ###
    ### A: input_select.kitchen_lights = 25%                                         ###
    ####################################################################################
  - alias: Kök 25% (sensor on, Hemma, 0-150)
    mode: queued

    trigger:
      - platform: state
        entity_id: input_boolean.rorelsedetektor_kok_aktiv
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_1
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_2
        to: 'on'
      - platform: state
        entity_id: switch.rorelsedetektor_3
        to: 'on'

    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: group.track_for_home_devices
          state: 'home'
        - condition: numeric_state
          entity_id: sensor.ljusstyrka
          below: 150
        - condition: time
          after: '12:00:00'
          before: '05:00:00'
        - condition: state
          entity_id: light.kok_lilla_fonstret
          state: 'off'

    action:
      - service: input_select.select_option
        data:
          entity_id: input_select.kitchen_lights
          option: 25%

    #########################################################
    ### Släcker lampor när ingen varit i köket på 9 min   ###
    ### T: input_boolean.rorelsedetektor_kok_aktiv == off ###
    ### A: input_select.kitchen_lights = Off              ###
    #########################################################
  - alias: Kök off (sensor off)
    mode: single

    trigger:
      platform: state
      entity_id: input_boolean.rorelsedetektor_kok_aktiv
      to: 'off'

    action:
      - service: input_select.select_option
        data:
          entity_id: input_select.kitchen_lights
          option: Off

    ##########################################################
    ### Släcker lampor när sista åker hemifrån             ###
    ### T: group.track_for_home_devices to: 'not_home'     ###
    ### A: input_boolean.rorelsedetektor_kok_aktiv = off   ###
    ##########################################################
  - alias: Kök off (-> borta)
    mode: single

    trigger:
      platform: state
      entity_id: group.track_for_home_devices
      from: 'home'
      to: 'not_home'

    action:
      - service: homeassistant.turn_off
        entity_id: input_boolean.rorelsedetektor_kok_aktiv

    ##############################################################
    ### Släcker lampor när lux kommer över 3000                ###
    ### T: sensor.ljusstyrka > input_number.kitchecn_light_off ###
    ### C: group.track_for_home_devices == 'home'              ###
    ### A: input_boolean.rorelsedetektor_kok_aktiv = off       ###
    ##############################################################
  - alias: Kök off (>3000)
    mode: single

    trigger:
      platform: template
      value_template: "{{(states('sensor.ljusstyrka') | int) > (states('input_number.kitchen_light_off') | int )}}"

    condition:
      condition: state
      entity_id: group.track_for_home_devices
      state: 'home'

    action:
      - service: homeassistant.turn_off
        entity_id: input_boolean.rorelsedetektor_kok_aktiv

    #########################################################################
    ### Sätter rörelsedetektor till off, för att kunna detektera nästa on ###
    ### Löser problemet med att lyset i vissa fall inte tänds i köket     ###
    ### T: light.kok_underskap_bank == off                                ###
    ### C: input_boolean.rorelsedetektor_kok_aktiv == on                  ###
    ### A: input_boolean.rorelsedetektor_kok_aktiv = off                  ###
    #########################################################################
  - alias: Kök Rörelsedetektor reset
    mode: single

    trigger:
      - platform: state
        entity_id:
          - light.kok_underskap_bank
        to: 'off'

    condition:
      condition: state
      entity_id: input_boolean.rorelsedetektor_kok_aktiv
      state: 'on'

    action:
      - service: homeassistant.turn_off
        entity_id: input_boolean.rorelsedetektor_kok_aktiv
