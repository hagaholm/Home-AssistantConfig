####################################################
#                                                  #
#                     SENSOR                       #
#                                                  #
####################################################
# https://home-assistant.io/components/sensor/

#############
# Tellstick #
#############
  - platform: tellstick
    only_named:

    ######################################################
    # Grannens regnmätare, visar senaste timme och total #
    ######################################################
    #13: Regnmätare
    #  - id: 18
    #    name: Regnmätare

    ################################
    # Husvagn, visar temp och fukt #
    ################################
      - id: 135
        name: Husvagn

    ###########################################
    # Används inte, krockade med grannens :-) #
    ###########################################
    #151: Frys

    ############################################
    # Grannens ute givare, visar temp och fukt #
    ############################################
#      - id: 151
#        name: Ute2

    ######################################
    # Louise rum, visar på temp och fukt #
    ######################################
      - id: 167 
        name: Louise rum

    ###################################
    # Frys i köket, visar temperature #
    # Ny termometer                   #
    ###################################
      - id: 208
        name: Frys

    ##################################
    # Kyl i köket, visar temperature #
    # Ny termometer                  #
    ##################################
      - id: 182
        name: Kyl

    ###################################
    # Tvättstuga, visar temp och fukt #
    # Värmepump, visar temp           #
    ###################################
      - id: 183
        name: Tvättstuga
      - id: 184
        name: Värmepump

    #####################################
    # Garage, visar temp och fukt       #
    # Förråd, visar temp                #
    #####################################
      - id: 199
        name: Garage
      - id: 200
        name: Förråd

    #####################################
    # Vardagsrum, visar temp            #
    # Ny termometer                     #
    # Fungerar inte, men hittad som 127 #
    #####################################
    #  - id: 180
    #    name: Vardagsrum

    ##################################
    # Andreas rum, visar temp        #
    # Ny termometer                  #
    ##################################
      - id: 127
        name: Andreas rum

    ##################################
    # friggebod, visar temp och fukt #
    ##################################
      - id: 215
        name: Friggebod

    #############################################
    # Grannens inne givare, visar temp och fukt #
    #############################################
    #  - id: 231
    #       name: Inne grannen

    ################################
    # Hall, visar på temp och fukt #
    ################################
#      - id: 247
#        name: Hall

    ############################################
    # Ute på friggebod, visar på temp och fukt #
    ############################################
      - id: 247
        name: Ute friggebod

#######################
# command_line 1-Wire #
#######################
#  - platform: command_line
#    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/28.9C97DA050000/temperature').text; print(str[12:])"
#    name: På vinden
#    value_template: '{{ value | round(1) | int(85) }}'
#    unit_of_measurement: "°C"
  - platform: command_line
    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/28.DB5AFE050000/temperature').text; print(str[12:])"
    name: Ute
    unit_of_measurement: "°C"
    value_template: '{{ value | round(1) | int(85) }}'
  - platform: command_line
    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/28.8378FD050000/temperature').text; print(str[12:])"
    name: Uterum
    unit_of_measurement: "°C"
    value_template: '{{ value | round(1) | int(85) }}'
  - platform: command_line
    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/28.AEA6FF050000/temperature').text; print(str[12:])"
    name: Sovrum
    unit_of_measurement: "°C"
    value_template: '{{ value | round(1) | int(85) }}'
  - platform: command_line
    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/28.C517FF050000/temperature').text; print(str[12:])"
    name: Uteluft
    unit_of_measurement: "°C"
    value_template: '{{ value | round(1) | int(85) }}'
  - platform: command_line
    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/28.B47DFF050000/temperature').text; print(str[12:])"
    name: Avluft
    unit_of_measurement: "°C"
    value_template: '{{ value | round(1) | int(85) }}'
  - platform: command_line
    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/28.93F7FC050000/temperature').text; print(str[12:])"
    name: Tilluft
    unit_of_measurement: "°C"
    value_template: '{{ value | round(1) | int(85) }}'
  - platform: command_line
    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/28.E485D9050000/temperature').text; print(str[12:])"
    name: Franluft
    unit_of_measurement: "°C"
    value_template: '{{ value | round(1) | int(85) }}'
    
  - platform: command_line
    command: python3 -c "import requests; str = requests.get('http://192.168.1.12:3001/text/12.A84D7D000000/PIO.A').text; print(str[6:])"
    name: Forcerad
    unit_of_measurement: ""
    value_template: '{{ value | round(1) | int(85) }}'

################
# command_line #
################
  - platform: command_line
    name: CPU Temperature
    command: "cat /sys/class/thermal/thermal_zone2/temp" # For raspberry use zone0
    # If errors occur, remove degree symbol below
    unit_of_measurement: "°C"
    value_template: '{{ value | multiply(0.001) | round(1) | int(85) }}'

##################
# mold_indicator #
##################
# calibration_factor = (temp_indoor - temp_outdoor) / (temp_criticalpoint - temp_outdoor)
# (21,6 - 0,8) / (17,2 - 0,8) = 1,268292682926829
# (21,6 - -1,0) / (17,2 - -1,0) = 1,241758241758242
  - platform: mold_indicator
    name: Fukt badrumsfönster
    indoor_temp_sensor: sensor.lumi_lumi_weather_temperature
    indoor_humidity_sensor: sensor.lumi_lumi_weather_humidity
    outdoor_temp_sensor: sensor.ute_friggebod_temperature
    calibration_factor: 1.25

##################
# Min/Max Sensor #
##################
  - platform: min_max
    name: Inne medel
    type: mean
    entity_ids:
      - sensor.lumi_lumi_weather_temperature_2
      - sensor.lumi_lumi_weather_temperature_4
      - sensor.sovrum
      - sensor.louise_rum_temperature
      - sensor.andreas_rum_temperature
    round_digits: 1

##############
# Statistics #
##############
# Not valid anymore in 2022.12. For more info:
# https://www.home-assistant.io/integrations/statistics/
# https://github.com/home-assistant/core/pull/69700
#  - platform: statistics
#    name: "Ftx medel"
#    entity_id: sensor.ftx
#    state_characteristic: mean
#    max_age:
#      hours: 24

  - platform: statistics
    name: "Förråd medeltemperatur"
    entity_id: sensor.forrad_temperature
    state_characteristic: mean
    max_age:
      hours: 24

  - platform: statistics
    name: "Ute medeltemperatur"
    entity_id: sensor.ute_friggebod_temperature
    state_characteristic: mean
    max_age:
      hours: 24

  - platform: statistics
    name: "Värmepump medeltemperatur"
    entity_id: sensor.varmepump_temperature
    state_characteristic: mean
    max_age:
      hours: 24
